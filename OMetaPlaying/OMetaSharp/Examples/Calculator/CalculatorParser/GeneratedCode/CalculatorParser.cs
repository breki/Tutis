using System;

namespace OMetaSharp.Examples
{
    public class CalculatorParser : OMeta
    {
        public override bool Digit(OMetaStream<char> inputStream, out OMetaList<HostExpression> result, out OMetaStream<char> modifiedStream)
        {
            Rule<char> __baseRule__ = base.Digit;
            OMetaList<HostExpression> d = null;
            modifiedStream = inputStream;
            if (!MetaRules.Apply(
                delegate(OMetaStream<char> inputStream2, out OMetaList<HostExpression> result2, out OMetaStream<char> modifiedStream2)
                {
                    modifiedStream2 = inputStream2;
                    if (!MetaRules.Apply(__baseRule__, modifiedStream2, out result2, out modifiedStream2))
                    {
                        return MetaRules.Fail(out result2, out modifiedStream2);
                    }
                    d = result2;
                    result2 = (d.As<int>()).AsHostExpressionList();
                    return MetaRules.Success();
                }, modifiedStream, out result, out modifiedStream))
            {
                return MetaRules.Fail(out result, out modifiedStream);
            }
            return MetaRules.Success();
        }
        public override bool Number(OMetaStream<char> inputStream, out OMetaList<HostExpression> result, out OMetaStream<char> modifiedStream)
        {
            Rule<char> __baseRule__ = base.Number;
            OMetaList<HostExpression> n = null;
            OMetaList<HostExpression> d = null;
            modifiedStream = inputStream;
            if (!MetaRules.Or(modifiedStream, out result, out modifiedStream,
            delegate(OMetaStream<char> inputStream2, out OMetaList<HostExpression> result2, out OMetaStream<char> modifiedStream2)
            {
                modifiedStream2 = inputStream2;
                if (!MetaRules.Apply(
                    delegate(OMetaStream<char> inputStream3, out OMetaList<HostExpression> result3, out OMetaStream<char> modifiedStream3)
                    {
                        modifiedStream3 = inputStream3;
                        if (!MetaRules.Apply(Number, modifiedStream3, out result3, out modifiedStream3))
                        {
                            return MetaRules.Fail(out result3, out modifiedStream3);
                        }
                        n = result3;
                        if (!MetaRules.Apply(Digit, modifiedStream3, out result3, out modifiedStream3))
                        {
                            return MetaRules.Fail(out result3, out modifiedStream3);
                        }
                        d = result3;
                        result3 = (n.As<int>() * 10 + d.As<int>()).AsHostExpressionList();
                        return MetaRules.Success();
                    }, modifiedStream2, out result2, out modifiedStream2))
                {
                    return MetaRules.Fail(out result2, out modifiedStream2);
                }
                return MetaRules.Success();
            }
            , delegate(OMetaStream<char> inputStream2, out OMetaList<HostExpression> result2, out OMetaStream<char> modifiedStream2)
            {
                modifiedStream2 = inputStream2;
                if (!MetaRules.Apply(Digit, modifiedStream2, out result2, out modifiedStream2))
                {
                    return MetaRules.Fail(out result2, out modifiedStream2);
                }
                return MetaRules.Success();
            }
            ))
            {
                return MetaRules.Fail(out result, out modifiedStream);
            }
            return MetaRules.Success();
        }
        public virtual bool AddExpr(OMetaStream<char> inputStream, out OMetaList<HostExpression> result, out OMetaStream<char> modifiedStream)
        {
            OMetaList<HostExpression> x = null;
            OMetaList<HostExpression> y = null;
            modifiedStream = inputStream;
            if (!MetaRules.Or(modifiedStream, out result, out modifiedStream,
            delegate(OMetaStream<char> inputStream2, out OMetaList<HostExpression> result2, out OMetaStream<char> modifiedStream2)
            {
                modifiedStream2 = inputStream2;
                if (!MetaRules.Apply(
                    delegate(OMetaStream<char> inputStream3, out OMetaList<HostExpression> result3, out OMetaStream<char> modifiedStream3)
                    {
                        modifiedStream3 = inputStream3;
                        if (!MetaRules.Apply(AddExpr, modifiedStream3, out result3, out modifiedStream3))
                        {
                            return MetaRules.Fail(out result3, out modifiedStream3);
                        }
                        x = result3;
                        if (!MetaRules.ApplyWithArgs(Exactly, modifiedStream3, out result3, out modifiedStream3, ("+").AsHostExpressionList()))
                        {
                            return MetaRules.Fail(out result3, out modifiedStream3);
                        }
                        if (!MetaRules.Apply(MulExpr, modifiedStream3, out result3, out modifiedStream3))
                        {
                            return MetaRules.Fail(out result3, out modifiedStream3);
                        }
                        y = result3;
                        result3 = (Sugar.Cons("add", x, y)).AsHostExpressionList();
                        return MetaRules.Success();
                    }, modifiedStream2, out result2, out modifiedStream2))
                {
                    return MetaRules.Fail(out result2, out modifiedStream2);
                }
                return MetaRules.Success();
            }
            , delegate(OMetaStream<char> inputStream2, out OMetaList<HostExpression> result2, out OMetaStream<char> modifiedStream2)
            {
                modifiedStream2 = inputStream2;
                if (!MetaRules.Apply(
                    delegate(OMetaStream<char> inputStream3, out OMetaList<HostExpression> result3, out OMetaStream<char> modifiedStream3)
                    {
                        modifiedStream3 = inputStream3;
                        if (!MetaRules.Apply(AddExpr, modifiedStream3, out result3, out modifiedStream3))
                        {
                            return MetaRules.Fail(out result3, out modifiedStream3);
                        }
                        x = result3;
                        if (!MetaRules.ApplyWithArgs(Exactly, modifiedStream3, out result3, out modifiedStream3, ("-").AsHostExpressionList()))
                        {
                            return MetaRules.Fail(out result3, out modifiedStream3);
                        }
                        if (!MetaRules.Apply(MulExpr, modifiedStream3, out result3, out modifiedStream3))
                        {
                            return MetaRules.Fail(out result3, out modifiedStream3);
                        }
                        y = result3;
                        result3 = (Sugar.Cons("sub", x, y)).AsHostExpressionList();
                        return MetaRules.Success();
                    }, modifiedStream2, out result2, out modifiedStream2))
                {
                    return MetaRules.Fail(out result2, out modifiedStream2);
                }
                return MetaRules.Success();
            }
            , delegate(OMetaStream<char> inputStream2, out OMetaList<HostExpression> result2, out OMetaStream<char> modifiedStream2)
            {
                modifiedStream2 = inputStream2;
                if (!MetaRules.Apply(MulExpr, modifiedStream2, out result2, out modifiedStream2))
                {
                    return MetaRules.Fail(out result2, out modifiedStream2);
                }
                return MetaRules.Success();
            }
            ))
            {
                return MetaRules.Fail(out result, out modifiedStream);
            }
            return MetaRules.Success();
        }
        public virtual bool MulExpr(OMetaStream<char> inputStream, out OMetaList<HostExpression> result, out OMetaStream<char> modifiedStream)
        {
            OMetaList<HostExpression> x = null;
            OMetaList<HostExpression> y = null;
            modifiedStream = inputStream;
            if (!MetaRules.Or(modifiedStream, out result, out modifiedStream,
            delegate(OMetaStream<char> inputStream2, out OMetaList<HostExpression> result2, out OMetaStream<char> modifiedStream2)
            {
                modifiedStream2 = inputStream2;
                if (!MetaRules.Apply(
                    delegate(OMetaStream<char> inputStream3, out OMetaList<HostExpression> result3, out OMetaStream<char> modifiedStream3)
                    {
                        modifiedStream3 = inputStream3;
                        if (!MetaRules.Apply(MulExpr, modifiedStream3, out result3, out modifiedStream3))
                        {
                            return MetaRules.Fail(out result3, out modifiedStream3);
                        }
                        x = result3;
                        if (!MetaRules.ApplyWithArgs(Exactly, modifiedStream3, out result3, out modifiedStream3, ("*").AsHostExpressionList()))
                        {
                            return MetaRules.Fail(out result3, out modifiedStream3);
                        }
                        if (!MetaRules.Apply(PrimExpr, modifiedStream3, out result3, out modifiedStream3))
                        {
                            return MetaRules.Fail(out result3, out modifiedStream3);
                        }
                        y = result3;
                        result3 = (Sugar.Cons("mul", x, y)).AsHostExpressionList();
                        return MetaRules.Success();
                    }, modifiedStream2, out result2, out modifiedStream2))
                {
                    return MetaRules.Fail(out result2, out modifiedStream2);
                }
                return MetaRules.Success();
            }
            , delegate(OMetaStream<char> inputStream2, out OMetaList<HostExpression> result2, out OMetaStream<char> modifiedStream2)
            {
                modifiedStream2 = inputStream2;
                if (!MetaRules.Apply(
                    delegate(OMetaStream<char> inputStream3, out OMetaList<HostExpression> result3, out OMetaStream<char> modifiedStream3)
                    {
                        modifiedStream3 = inputStream3;
                        if (!MetaRules.Apply(MulExpr, modifiedStream3, out result3, out modifiedStream3))
                        {
                            return MetaRules.Fail(out result3, out modifiedStream3);
                        }
                        x = result3;
                        if (!MetaRules.ApplyWithArgs(Exactly, modifiedStream3, out result3, out modifiedStream3, ("/").AsHostExpressionList()))
                        {
                            return MetaRules.Fail(out result3, out modifiedStream3);
                        }
                        if (!MetaRules.Apply(PrimExpr, modifiedStream3, out result3, out modifiedStream3))
                        {
                            return MetaRules.Fail(out result3, out modifiedStream3);
                        }
                        y = result3;
                        result3 = (Sugar.Cons("div", x, y)).AsHostExpressionList();
                        return MetaRules.Success();
                    }, modifiedStream2, out result2, out modifiedStream2))
                {
                    return MetaRules.Fail(out result2, out modifiedStream2);
                }
                return MetaRules.Success();
            }
            , delegate(OMetaStream<char> inputStream2, out OMetaList<HostExpression> result2, out OMetaStream<char> modifiedStream2)
            {
                modifiedStream2 = inputStream2;
                if (!MetaRules.Apply(PrimExpr, modifiedStream2, out result2, out modifiedStream2))
                {
                    return MetaRules.Fail(out result2, out modifiedStream2);
                }
                return MetaRules.Success();
            }
            ))
            {
                return MetaRules.Fail(out result, out modifiedStream);
            }
            return MetaRules.Success();
        }
        public virtual bool PrimExpr(OMetaStream<char> inputStream, out OMetaList<HostExpression> result, out OMetaStream<char> modifiedStream)
        {
            OMetaList<HostExpression> x = null;
            OMetaList<HostExpression> n = null;
            modifiedStream = inputStream;
            if (!MetaRules.Or(modifiedStream, out result, out modifiedStream,
            delegate(OMetaStream<char> inputStream2, out OMetaList<HostExpression> result2, out OMetaStream<char> modifiedStream2)
            {
                modifiedStream2 = inputStream2;
                if (!MetaRules.Apply(
                    delegate(OMetaStream<char> inputStream3, out OMetaList<HostExpression> result3, out OMetaStream<char> modifiedStream3)
                    {
                        modifiedStream3 = inputStream3;
                        if (!MetaRules.ApplyWithArgs(Exactly, modifiedStream3, out result3, out modifiedStream3, ("(").AsHostExpressionList()))
                        {
                            return MetaRules.Fail(out result3, out modifiedStream3);
                        }
                        if (!MetaRules.Apply(Expr, modifiedStream3, out result3, out modifiedStream3))
                        {
                            return MetaRules.Fail(out result3, out modifiedStream3);
                        }
                        x = result3;
                        if (!MetaRules.ApplyWithArgs(Exactly, modifiedStream3, out result3, out modifiedStream3, (")").AsHostExpressionList()))
                        {
                            return MetaRules.Fail(out result3, out modifiedStream3);
                        }
                        result3 = (x).AsHostExpressionList();
                        return MetaRules.Success();
                    }, modifiedStream2, out result2, out modifiedStream2))
                {
                    return MetaRules.Fail(out result2, out modifiedStream2);
                }
                return MetaRules.Success();
            }
            , delegate(OMetaStream<char> inputStream2, out OMetaList<HostExpression> result2, out OMetaStream<char> modifiedStream2)
            {
                modifiedStream2 = inputStream2;
                if (!MetaRules.Apply(
                    delegate(OMetaStream<char> inputStream3, out OMetaList<HostExpression> result3, out OMetaStream<char> modifiedStream3)
                    {
                        modifiedStream3 = inputStream3;
                        if (!MetaRules.Apply(Number, modifiedStream3, out result3, out modifiedStream3))
                        {
                            return MetaRules.Fail(out result3, out modifiedStream3);
                        }
                        n = result3;
                        result3 = (Sugar.Cons("num", n)).AsHostExpressionList();
                        return MetaRules.Success();
                    }, modifiedStream2, out result2, out modifiedStream2))
                {
                    return MetaRules.Fail(out result2, out modifiedStream2);
                }
                return MetaRules.Success();
            }
            ))
            {
                return MetaRules.Fail(out result, out modifiedStream);
            }
            return MetaRules.Success();
        }
        public virtual bool Expr(OMetaStream<char> inputStream, out OMetaList<HostExpression> result, out OMetaStream<char> modifiedStream)
        {
            modifiedStream = inputStream;
            if (!MetaRules.Apply(AddExpr, modifiedStream, out result, out modifiedStream))
            {
                return MetaRules.Fail(out result, out modifiedStream);
            }
            return MetaRules.Success();
        }
    }
}
